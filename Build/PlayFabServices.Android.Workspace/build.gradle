apply plugin: 'java'
import java.util.regex.Matcher
import java.util.regex.Pattern

// Top-level build file where you can add configuration options common to all sub-projects/modules.
buildscript {
    repositories {
        mavenCentral()
        maven {
            url "https://maven.google.com"
        }
    }

    dependencies {
        classpath 'com.android.tools.build:gradle:4.1.2'
    }
}

allprojects {
    repositories {
        mavenCentral()
        maven {
            url "https://maven.google.com"
        }
    }
}

subprojects.each { prj ->
    // Put all the Gradle build files under the /Int directory
    def binariesDir = project.file("../../Int/Android/${prj.name}").getAbsolutePath()
    prj.buildDir = new File(binariesDir)

    // If usePlayFabCore is enabled, build the shared library version of LHC
    prj.ext.BUILD_SHARED_LIBS = true
}

project(":libHttpClient.Android") {
    // Put all the Gradle build files under the LHC /Binaries directory
    // This file path is relative from the LHC.Android `build.gradle` location
    def binariesDir = project.file("../../Binaries/Android/${name}").getAbsolutePath()
    buildDir = new File(binariesDir)
}

ext.getTaskFlavorName = { taskPrefix, task ->

    Pattern pattern
    pattern = Pattern.compile(taskPrefix + "(\\w+)(Release|Debug)")

    Matcher matcher = pattern.matcher( task.name )
    if( matcher.find() )
        return matcher.group(1)

    return ""
}
